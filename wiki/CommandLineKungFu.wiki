#CommandLine KungFu which our team members uses.

= Introduction =

We will be updating this page with all the commandline KungFu that our team members uses during our Malware analysis.


= Details =
* Search through file for all IP addresses

{{{
egrep file.txt "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]"
}}}


* Search for IP addresses in files contained within file.gz

{{{
zgrep file.gz "[0-9]+\.[0-9]+\.[0-9]+\.[0-9]"
}}}


* Get IP addresses from file.gz which is stored in the following format: Time/Date IP address port

{{{
zcat file.gz | cut -d' ' -f 2
}}}


The following are PCRE Regex for extracting certain keywords that we are usually interested in.
{{{
meta_tag=(?i)(?:<[\s*]{0,1}meta http-equiv[\s*]{0,1}=[\s*]{0,1}["']{0,1}refresh["']{0,1}[^>]*)content[\s*]?=[\s*]?\"(.*?)\"

document_location=(?i)(?:[\s*]{0,1}document\.location[\s*]{0,1})=(?:[\s*]{0,1}["']{0,1})?(.*?)(?:['"]{0,1})(?:;)

location_href=(?i)(?:[\s*]{0,1}location\.href[\s*]{0,1})=(?:[\s*]{0,1}["']{0,1})?(.*?)(?:['"]{0,1})(?:;)

window_location=(?i)(?:[\s*]{0,1}window\.location[\s*]{0,1})=(?:[\s*]{0,1}["']{0,1})?(.*?)(?:['"]{0,1})(?:;)

base_href= (?i)(?:<[\s*]{0,1}i?base[^>]*)href[\s*]?=[\s*]?["']{0,1}(.*?)['"]{0,1}(?: |>|\s)

href=(?i)(?<=href=['|"])[^'|"]*?(?=['|"])

embed_src=(?i)(?:<[\s*]{0,1}embed[^>]*)src[\s*]?=[\s*]?["']{0,1}(.*?)['"]{0,1}(?: |>|\s)

applet_archive=(?i)(?:<[\s*]{0,1}applet[^>]*)archive[\s*]?=[\s*]?["']{0,1}(.*?)['"]{0,1}(?: |>|\s)

applet_class=(?i)(?:<[\s*]{0,1}applet[^>]*)code[\s*]?=[\s*]?["']{0,1}(.*?)['"]{0,1}(?: |>|\s)

applet_param=(?i)(?:<[\s*]{0,1}param[^>]*)value[\s*]?=[\s*]?["']{0,1}(.*?)(?: |>|\s)

object_type=(?i)(?:<[\s*]{0,1}object[^>]*)type[\s*]?=[\s*]?["']{0,1}(.*?)['"]{0,1}(?: |>|\s)

object_param=(?i)(?:<[\s*]{0,1}param name="archive"[^>]*)value[\s*]?=[\s*]?["']{0,1}(.*?)['"]{0,1}(?: |>|\s)
}}}